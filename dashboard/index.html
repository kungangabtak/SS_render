<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hole Cards Dashboard</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="page">
      <header class="header">
        <div>
          <h1>Hole Cards Dashboard</h1>
          <p class="subhead">Multi-publisher view — subscribe to your WebSocket hub and display hole cards from multiple extension instances.</p>
        </div>
        <div class="status" id="statusBadge" data-status="disconnected">
          <span class="dot" aria-hidden="true"></span>
          <span class="text" id="statusText">disconnected</span>
        </div>
      </header>

      <section class="panel">
        <div class="grid">
          <div class="field">
            <label for="hubInput">Hub WSS base</label>
            <input
              id="hubInput"
              type="text"
              spellcheck="false"
              placeholder="wss://dom-hub.onrender.com/"
              value="wss://dom-hub.onrender.com/"
              autocomplete="off"
            />
            <div class="hint">Example: <code>wss://dom-hub.onrender.com/</code></div>
          </div>

          <div class="field">
            <label for="gameIdInput">Game ID (Room)</label>
            <input
              id="gameIdInput"
              type="text"
              spellcheck="false"
              placeholder="pglQ2HgWGgYbDUSq7f9moVbXR"
              autocomplete="off"
            />
            <div class="hint">Paste full PokerNow URL or just the game ID</div>
          </div>

          <div class="field">
            <label for="tokenInput">Token</label>
            <input id="tokenInput" type="password" spellcheck="false" placeholder="HUB_TOKEN" autocomplete="off" />
          </div>

          <div class="actions">
            <button id="connectBtn" class="btn primary">Connect</button>
            <button id="disconnectBtn" class="btn" disabled>Disconnect</button>
            <button id="clearLogBtn" class="btn danger" title="Clear message log">Clear log</button>
          </div>
        </div>
      </section>

      <!-- Publishers Panel -->
      <section class="panel publishersPanel">
        <div class="publishersHeader">
          <h2>Publishers <span class="pubCount" id="publisherCount"></span></h2>
          <div class="publishersHint">Click a publisher to select and view their data</div>
        </div>
        <div class="publishersList" id="publishersList">
          <div class="pubEmpty">No publishers yet. Waiting for messages...</div>
        </div>
      </section>

      <!-- Two-column layout: Cards + JSON Viewer -->
      <div class="twoCol">
        <!-- Left: Cards Display -->
        <section class="panel cardsPanel">
          <div class="cardsHeader">
            <h2>Latest hand</h2>
            <div class="meta" id="selectedPublisherInfo" hidden>
              <div class="metaRow">
                <span class="metaLabel">Publisher</span>
                <span class="metaValue" id="selectedPublisherId">—</span>
              </div>
              <div class="metaRow">
                <span class="metaLabel">Last seen</span>
                <span class="metaValue" id="selectedPublisherLastSeen">—</span>
              </div>
              <div class="metaRow">
                <span class="metaLabel">Last update</span>
                <span class="metaValue" id="lastUpdate">—</span>
              </div>
              <div class="metaRow" id="tableUrlRow" hidden>
                <span class="metaLabel">Table</span>
                <a class="metaValue link" id="tableUrl" href="#" target="_blank" rel="noreferrer">—</a>
              </div>
            </div>
          </div>

          <div class="cards" aria-label="Latest hole cards">
            <div class="cardTile" id="card1" data-color="black" aria-label="Card 1">
              <div class="value" id="card1Value">—</div>
              <div class="suit" id="card1Suit">?</div>
            </div>
            <div class="cardTile" id="card2" data-color="black" aria-label="Card 2">
              <div class="value" id="card2Value">—</div>
              <div class="suit" id="card2Suit">?</div>
            </div>
          </div>
        </section>

        <!-- Right: JSON Viewer -->
        <section class="panel jsonPanel">
          <div class="jsonHeader">
            <h2>Message Types</h2>
            <div class="jsonHint">Click to expand full JSON</div>
          </div>
          <div class="jsonViewer" id="jsonViewer">
            Select a publisher to view details.
          </div>
        </section>
      </div>

      <section class="panel">
        <div class="logHeader">
          <h2>Message log</h2>
          <div class="logHint">Last ~50 messages. Click a row to expand raw JSON.</div>
        </div>
        <div class="log" id="log"></div>
      </section>

      <footer class="footer">
        <span class="muted">Tip: open with query params <code>?hub=...&amp;gameId=...&amp;token=...</code> to auto-connect.</span>
      </footer>
    </div>

    <script src="./app.js"></script>
  </body>
</html>
